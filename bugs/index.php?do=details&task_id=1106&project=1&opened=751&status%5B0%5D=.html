<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-AU" xml:lang="en-AU">
  <head>
    <title>FS#1106 : &quot;Dynamic&quot; titlebar + fullscreen: unused space</title>

    <meta name="description" content="Flyspray, a Bug Tracking System written in PHP." />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <link rel="icon" type="image/png" href="https://awesomewm.org/bugs/themes/Bluey/favicon.ico" />
    <link rel="index" id="indexlink" type="text/html" href="https://awesomewm.org/bugs/" />
        <link media="screen" href="https://awesomewm.org/bugs/themes/Bluey/theme.css" rel="stylesheet" type="text/css" />
    <link media="print"  href="https://awesomewm.org/bugs/themes/Bluey/theme_print.css" rel="stylesheet" type="text/css" />
    <link rel="alternate" type="application/rss+xml" title="Flyspray RSS 1.0 Feed"
          href="https://awesomewm.org/bugs/feed.php?feed_type=rss1&amp;project=1" />
    <link rel="alternate" type="application/rss+xml" title="Flyspray RSS 2.0 Feed"
          href="https://awesomewm.org/bugs/feed.php?feed_type=rss2&amp;project=1" />
	<link rel="alternate" type="application/atom+xml" title="Flyspray Atom 0.3 Feed"
	      href="https://awesomewm.org/bugs/feed.php?feed_type=atom&amp;project=1" />

    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/prototype/prototype.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/script.aculo.us/scriptaculous.js"></script>
            <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/details.js"></script>
                <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/tabs.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/functions.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/jscalendar/calendar_stripped.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/jscalendar/calendar-setup_stripped.js"> </script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/jscalendar/lang/calendar-en.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/lightbox/js/lightbox.js"></script>
    <link rel="stylesheet" href="https://awesomewm.org/bugs/javascript/lightbox/css/lightbox.css" type="text/css" media="screen" />
    <!--[if IE]>
    <link media="screen" href="https://awesomewm.org/bugs/themes/Bluey/ie.css" rel="stylesheet" type="text/css" />
    <![endif]-->
      </head>
  <body onload="perms = new Perms('permissions');">

  <div id="container">
    <!-- Remove this to remove the logo -->
    <h1 id="title"><a href="https://awesomewm.org/bugs/">awesome</a></h1>

    <div id="menu">

<form id="login" action="https://awesomewm.org/bugs/index.php?do=authenticate" method="post">
<div>
  <label for="lbl_user_name">Username</label>
  <input class="text" type="text" id="lbl_user_name" name="user_name" size="17" maxlength="30" />

  <label for="lbl_password">Password</label>
  <input class="password" type="password" id="lbl_password" name="password" size="17" maxlength="30" />

  <label for="lbl_remember">Remember me</label>
  <input type="checkbox" id="lbl_remember" name="remember_login" />
  
  <input type="hidden" name="return_to" value="/bugs/index.php?do=details&amp;task_id=1106&amp;project=1&amp;opened=751&amp;status%5B0%5D=" />

  <button accesskey="l" type="submit">Login!</button>

  <span id="links">
            <a id="forgotlink" href="https://awesomewm.org/bugs/index.php?do=lostpw">Lost password?</a>
      </span>
</div>
</form>
</div>

<div id="pm-menu">

<div id="projectselector">
    <form id="projectselectorform" action="https://awesomewm.org/bugs/index.php" method="get">
       <div>
        <select name="project" onChange="document.getElementById('projectselectorform').submit()">
          <option value="0">All Projects</option>        </select>
        <button type="submit">Switch</button>
        <input type="hidden" name="do" value="details" />
        <input type="hidden" value="1" name="switch" />
              </div>
    </form>
</div>

<ul id="pm-menu-list">
    <li class="first">
      <a id="toplevellink" href="https://awesomewm.org/bugs/index.php?do=toplevel&amp;project=1">Overview</a>
    </li>

    <li>
    <a id="homelink"
        href="https://awesomewm.org/bugs/index.php?project=1&amp;do=index">Tasklist</a>
    </li>

    
    
        <li>
    <a id="roadmaplink"
        href="https://awesomewm.org/bugs/index.php?do=roadmap&amp;project=1">Roadmap</a>
    </li>
    
    
    </ul>
</div>

    
    <div id="content">
      <div id="showtask">
        <form action="https://awesomewm.org/bugs/index.php" method="get">
          <div>
            <button type="submit">Show Task #</button>
            <input id="taskid" name="show_task" class="text" type="text" size="10" accesskey="t" />
          </div>
        </form>
      </div>

      <div class="clear"></div>
            <div id="intromessage">Welcome to awesome bug tracking system.</div>
      <div id="taskdetails">
<span id="navigation">       <a href="https://awesomewm.org/bugs/index.php?project=1&amp;do=index&amp;opened=751&amp;status%5B0%5D=">Tasklist</a>
   |     <del>&#160;<a href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1049&amp;project=1&amp;opened=751&amp;status%5B0%5D=" title="Fixed | awful.tag.getidx() returns nil | 100%"  id = "next" accesskey = "n" class = "closedtasklink">Next task</a>&#160;</del>  </span>

  <h2 class="summary severity2">
	 FS#1106 - &quot;Dynamic&quot; titlebar + fullscreen: unused space  </h2>

  <div id="fineprint">
	 Attached to Project:
	 <a href="/bugs/index.php?project=1">awesome</a>
	 <br />
	 Opened by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=751">Alexander Hirsch (z33ky)</a>     	 - Wednesday, 06 February 2013, 16:47 GMT 	 	 <br />
	 Last edited by  <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a>	 - Friday, 04 October 2013, 10:05 GMT 	   </div>

  <table><tr><td id="taskfieldscell">
  <div id="taskfields">
	 <table>
		<tr>
		  <th id="tasktype">Task Type</th>
		  <td headers="tasktype">Bug Report</td>
		</tr>
		<tr>
		  <th id="category">Category</th>
		  <td headers="category">
			 			 Core		  </td>
		</tr>
		<tr>
		  <th id="status">Status</th>
		  <td headers="status">
			 			 Closed			 		  </td>
		</tr>
		<tr>
		  <th id="assignedto">Assigned To</th>
		  <td headers="assignedto">
			 			 No-one			 		  </td>
		</tr>
		<tr>
		  <th id="os">Operating System</th>
		  <td headers="os">All</td>
		</tr>
		<tr>
		  <th id="severity">Severity</th>
		  <td headers="severity">Low</td>
		</tr>
		<tr>
		  <th id="priority">Priority</th>
		  <td headers="priority">Normal</td>
		</tr>
		<tr>
		  <th id="reportedver">Reported Version</th>
		  <td headers="reportedver">3.5</td>
		</tr>
		<tr>
		  <th id="dueversion">Due in Version</th>
		  <td headers="dueversion">
			 			 3.5.2			 		  </td>
		</tr>
		<tr>
		  <th id="duedate">Due Date</th>
		  <td headers="duedate">
			 Undecided		  </td>
		</tr>
		<tr>
		  <th id="percent">Percent Complete</th>
		  <td headers="percent">
			 <img src="https://awesomewm.org/bugs/themes/Bluey/percent-100.png"
				title="100% complete"
				alt="100%" />
		  </td>
		</tr>
        <tr class="votes">
		  <th id="votes">Votes</th>
		  <td headers="votes">
                    0
                              </td>
        </tr>
        <tr>
		  <th id="private">Private</th>
		  <td headers="private">
                        No            
                      </td>
        </tr>
        	 </table>
  </div>

  </td><td>

  <div id="taskdetailsfull">
	 <h3 class="taskdesc">Details</h3>
     <div id="taskdetailstext">Using awesome 3.5 (stable) and v3.5-20-g03759b4.<br />
<br />
I want to to automatically add titlebars to any floating client by watching the floating property.<br />
Setting the titlebar works fine, but just doing awful.titlebar(c):set_widget() does not completely remove it. The text, icon and buttons will be gone, but the bar itself is still there. As a workaround I currently just set the size property to 0 when I want to disable it.<br />
Code:<br />
    -- bottom of manage-callback<br />
    local title_prop = {}<br />
    if not awful.client.floating.get(c) then<br />
        title_prop.size = 0<br />
    end<br />
    awful.titlebar(c, title_prop):set_widget(titlebar)<br />
<br />
    -- Automatically toggle titblebar<br />
    c:connect_signal(&quot;property::floating&quot;, function(c)<br />
        local title_prop = {}<br />
        if not awful.client.floating.get(c) then<br />
            title_prop.size = 0<br />
        end<br />
        awful.titlebar(c, title_prop)<br />
    end)<br />
<br />
This seems to do the trick.<br />
<br />
Actual issue:<br />
When I go fullscreen (via Mod4 + f) with a client that I switched to floating mode (and the code thus added a titlebar to) there is some emptyish space on the bottom of the client. It seems to be the same size as the titlebar.<br />
By emptyish I mean that the client does seem to occupy the space, but is not properly drawing to it.<br />
<br />
When I then disable the titlebar (or rather: set its height to 0) and attempt to go fullscreen, it just maximizes.<br />
<br />
Fullscreen works just fine when I never go to floating mode in the first place, it only starts happening when I start toggling it.</div>

       
  </div>

  </td></tr></table>

  <div id="taskinfo">
	 <div id="taskdeps">
		<b>This task depends upon</b>
		<br />
		
		<br class="DoNotPrint" />

		
			 </div>

	 <div id="taskblocks">
        			 </div>
  </div>

    <div id="taskclosed">
      Closed by&nbsp;&nbsp;<a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a><br />
      Friday, 04 October 2013, 10:05 GMT <br />
      <strong>Reason for closing:</strong> &nbsp;Fixed<br />
            <strong>Additional comments about closing:</strong> &nbsp;commit
f3573dbb198a06bd12bfb0b7c6a8fcabad417dcd
<br />
Author: Uli Schlachter
&lt;psychon@znc.in&gt;<br />
Date:   Fri Oct 4 12:04:16 2013 +0200<br
/>
<br />
    awful.client.tiled: Ignore
fullscreen (etc) clients (<del>&#160;<a
href="https://awesomewm.org/bugs/index.p
hp?do=details&amp;task_id=1106&amp;proje
ct=1&amp;opened=751&amp;status%5B0%5D="
title="Fixed | &quot;Dynamic&quot;
titlebar + fullscreen: unused space |
100%"  class =
"closedtasklink">FS#1106</a>&#160;</del>
)<br />
    <br />
    I am looking forward to the bug
reports requesting
awful.client.floating.set(c,<br />
    true) to also automatically
un-fullscreen the client...<br />
    <br />
    Signed-off-by: Uli Schlachter
&lt;psychon@znc.in&gt;<br />        </div>
  
  <div id="actionbuttons">
	 
	 
	 	   </div>
</div>
<ul id="submenu">
    <li id="commentstab">
  <a href="#comments">Comments (8)</a>
  </li>
  
  <li id="relatedtab">
  <a href="#related">Related Tasks (0/0)</a>
  </li>

  
  </ul>
<div id="comments" class="tab">
    <em>
    <a name="comment3461" id="comment3461"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1106#comment3461">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a> -
    Sunday, 24 February 2013, 14:11 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">OK, I added the following to the end of the default config:<br />
<br />
<br />
local foo = function(c)<br />
	local title_prop = {}<br />
	if not awful.client.floating.get(c) then<br />
		title_prop.size = 0<br />
	end<br />
	awful.titlebar(c, title_prop)<br />
end<br />
client.connect_signal(&quot;property::floating&quot;, foo)<br />
client.connect_signal(&quot;manage&quot;, foo)<br />
<br />
I then started urxvt and played a little with its floating mode (ctrl+mod+space), fullscreen mode (mod+f) and maximized (mod+m). Everything seems to work the way I&#039;d expect it to work.<br />
<br />
To me it sounds like I can&#039;t reproduce this issue. Did I miss anything?</div></div>

  
    <em>
    <a name="comment3463" id="comment3463"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1106#comment3463">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=751">Alexander Hirsch (z33ky)</a> -
    Sunday, 24 February 2013, 14:38 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">I tried just now using the default config and adding the same as you. The issue persists (v3.5-31-g2de450d).<br />
Perhaps something driver related? I have this issue on the proprietary nVidia driver and the kernel integrated i915 driver (separate computers, no Optimus/Bumblebee).<br />
Or toolkit dependent? I see the issue on evilvte with GTK3 and chromium with GTK2.</div></div>

  
    <em>
    <a name="comment3464" id="comment3464"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1106#comment3464">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=751">Alexander Hirsch (z33ky)</a> -
    Sunday, 24 February 2013, 14:43 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">The exact steps to produce the bug (at least on my computers) are:<br />
Ctrl+Mod4+Space, Mod4+f -&gt; unused/empty space at the bottom<br />
Select a non-floating tag-layout.<br />
Then doing Ctrl+Mod4+Space -&gt; client does not go fullscreen on Mod4+f anymore.</div></div>

  
    <em>
    <a name="comment3465" id="comment3465"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1106#comment3465">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a> -
    Sunday, 24 February 2013, 15:37 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">Ok, I have no idea how this ever was supposed to work. The attached patch is ugly, but seems to solve at least some issue. However, there might be more stuff wrong here.</div></div>

      <div class="attachments">
          <a title="awful_dont_tile_fullscreen.patch" href="?getfile=594" >
                <img src="https://awesomewm.org/bugs/themes/Bluey/mime/text.png" alt="" title="text/x-diff; charset=us-ascii" />
            &nbsp;&nbsp;
            awful_dont_tile_fullscreen.pa...
                  </a>
                  (0.6 KiB)
          <br />
    </div>
  

    <em>
    <a name="comment3467" id="comment3467"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1106#comment3467">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=751">Alexander Hirsch (z33ky)</a> -
    Sunday, 24 February 2013, 16:55 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">That does seem to make the fullscreening to always maximize the window correctly.<br />
However, the unused/empty space issue is still there.<br />
<br />
I noticed, that when enabling the titlebar, going fullscreen and then toggling the titlebar switches between two states:<br />
When it is enabled, the space is filled by what I think is the background color of the toolkit, when it is disabled you can see awesomes background/wallpaper.</div></div>

  
    <em>
    <a name="comment3490" id="comment3490"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1106#comment3490">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a> -
    Sunday, 10 March 2013, 11:23 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">The &quot;unused space at the bottom&quot; seems to be a duplicate of <del>&#160;<a href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1093&amp;project=1&amp;opened=751&amp;status%5B0%5D=" title="Fixed | Enabling local titlebars creates bar across bottom in fullscreen | 100%"  class = "closedtasklink">FS#1093</a>&#160;</del>.<br />
<br />
So all that is left here is the &quot;don&#039;t tile fullscreen clients&quot;-part.</div></div>

  
    <em>
    <a name="comment3503" id="comment3503"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1106#comment3503">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a> -
    Tuesday, 12 March 2013, 18:00 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">Here is some new patch which I like more than the previous one.<br />
<br />
When you fullscreen a client, it automatically loses any maximized, above,... state. This patch implements something similar for floating: Fullscreen or maximized clients are always forced to be floating.<br />
Additionally, clients are now un-fullscreend/maximized if they are set floating.<br />
<br />
However, this patch breaks client.floating.toggle() :-/</div></div>

      <div class="attachments">
          <a title="awful-floating-magic.patch" href="?getfile=598" >
                <img src="https://awesomewm.org/bugs/themes/Bluey/mime/text.png" alt="" title="text/x-diff; charset=us-ascii" />
            &nbsp;&nbsp;
            awful-floating-magic.patch
                  </a>
                  (1.5 KiB)
          <br />
    </div>
  

    <em>
    <a name="comment3506" id="comment3506"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1106#comment3506">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=751">Alexander Hirsch (z33ky)</a> -
    Tuesday, 12 March 2013, 18:47 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">Perhaps this would work if you add a client.should_tile-function instead of using the client.floating.get function to determine whether to include a client in the tiling algorithm or not.</div></div>

  
  
  </div>
<div id="related" class="tab">
  <table>    <tr><td>
    <form method="post" action="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1106#related" >
        <table id="tasks_related" class="userlist">
        <tr>
          <th>
            <a href="javascript:ToggleSelected('tasks_related')">
              <img title="Toggle Selected" alt="Toggle Selected" src="https://awesomewm.org/bugs/themes/Bluey/kaboodleloop.png" width="16" height="16" />
            </a>
          </th>
          <th>Tasks related to this task (0)</th>
        </tr>
                <tr>
          <td colspan="2">
            <input type="hidden" name="action" value="remove_related" />
            <input type="hidden" name="task_id" value="1106" />
            <button type="submit">Remove</button>
          </td>
        </tr>
        </table>
    </form>
    </td><td>
    
    <table id="duplicate_tasks" class="userlist">
        <tr>
          <th>Duplicate tasks of this task (0)</th>
        </tr>
            </table>
    </td></tr>
  </table>

  </div>
<div id="history" class="tab">
  <h3>Loading...</h3>
</div>
    </div>
    <p id="footer">
       <!-- Please don't remove this line - it helps promote Flyspray -->
       <a href="http://flyspray.org/" class="offsite">Powered by Flyspray</a>
    </p>
  </div>
  </body>
</html>
