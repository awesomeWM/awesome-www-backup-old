<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-AU" xml:lang="en-AU">
  <head>
    <title>FS#385 : passing keypresses to a client</title>

    <meta name="description" content="Flyspray, a Bug Tracking System written in PHP." />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <link rel="icon" type="image/png" href="https://awesomewm.org/bugs/themes/Bluey/favicon.ico" />
    <link rel="index" id="indexlink" type="text/html" href="https://awesomewm.org/bugs/" />
        <link media="screen" href="https://awesomewm.org/bugs/themes/Bluey/theme.css" rel="stylesheet" type="text/css" />
    <link media="print"  href="https://awesomewm.org/bugs/themes/Bluey/theme_print.css" rel="stylesheet" type="text/css" />
    <link rel="alternate" type="application/rss+xml" title="Flyspray RSS 1.0 Feed"
          href="https://awesomewm.org/bugs/feed.php?feed_type=rss1&amp;project=1" />
    <link rel="alternate" type="application/rss+xml" title="Flyspray RSS 2.0 Feed"
          href="https://awesomewm.org/bugs/feed.php?feed_type=rss2&amp;project=1" />
	<link rel="alternate" type="application/atom+xml" title="Flyspray Atom 0.3 Feed"
	      href="https://awesomewm.org/bugs/feed.php?feed_type=atom&amp;project=1" />

    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/prototype/prototype.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/script.aculo.us/scriptaculous.js"></script>
            <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/details.js"></script>
                <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/tabs.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/functions.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/jscalendar/calendar_stripped.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/jscalendar/calendar-setup_stripped.js"> </script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/jscalendar/lang/calendar-en.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/lightbox/js/lightbox.js"></script>
    <link rel="stylesheet" href="https://awesomewm.org/bugs/javascript/lightbox/css/lightbox.css" type="text/css" media="screen" />
    <!--[if IE]>
    <link media="screen" href="https://awesomewm.org/bugs/themes/Bluey/ie.css" rel="stylesheet" type="text/css" />
    <![endif]-->
      </head>
  <body onload="perms = new Perms('permissions');">

  <div id="container">
    <!-- Remove this to remove the logo -->
    <h1 id="title"><a href="https://awesomewm.org/bugs/">awesome</a></h1>

    <div id="menu">

<form id="login" action="https://awesomewm.org/bugs/index.php?do=authenticate" method="post">
<div>
  <label for="lbl_user_name">Username</label>
  <input class="text" type="text" id="lbl_user_name" name="user_name" size="17" maxlength="30" />

  <label for="lbl_password">Password</label>
  <input class="password" type="password" id="lbl_password" name="password" size="17" maxlength="30" />

  <label for="lbl_remember">Remember me</label>
  <input type="checkbox" id="lbl_remember" name="remember_login" />
  
  <input type="hidden" name="return_to" value="/bugs/index.php?do=details&amp;task_id=385" />

  <button accesskey="l" type="submit">Login!</button>

  <span id="links">
            <a id="forgotlink" href="https://awesomewm.org/bugs/index.php?do=lostpw">Lost password?</a>
      </span>
</div>
</form>
</div>

<div id="pm-menu">

<div id="projectselector">
    <form id="projectselectorform" action="https://awesomewm.org/bugs/index.php" method="get">
       <div>
        <select name="project" onChange="document.getElementById('projectselectorform').submit()">
          <option value="0">All Projects</option>        </select>
        <button type="submit">Switch</button>
        <input type="hidden" name="do" value="details" />
        <input type="hidden" value="1" name="switch" />
              </div>
    </form>
</div>

<ul id="pm-menu-list">
    <li class="first">
      <a id="toplevellink" href="https://awesomewm.org/bugs/index.php?do=toplevel&amp;project=1">Overview</a>
    </li>

    <li>
    <a id="homelink"
        href="https://awesomewm.org/bugs/index.php?project=1&amp;do=index">Tasklist</a>
    </li>

    
    
        <li>
    <a id="roadmaplink"
        href="https://awesomewm.org/bugs/index.php?do=roadmap&amp;project=1">Roadmap</a>
    </li>
    
    
    </ul>
</div>

    
    <div id="content">
      <div id="showtask">
        <form action="https://awesomewm.org/bugs/index.php" method="get">
          <div>
            <button type="submit">Show Task #</button>
            <input id="taskid" name="show_task" class="text" type="text" size="10" accesskey="t" />
          </div>
        </form>
      </div>

      <div class="clear"></div>
            <div id="intromessage">Welcome to awesome bug tracking system.</div>
      <div id="taskdetails">
<span id="navigation">   <del>&#160;<a href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=387" title="Implemented | setting and getting selection buffer | 50%"  id = "prev" accesskey = "p" class = "closedtasklink">Previous task</a>&#160;</del>     |     <a href="https://awesomewm.org/bugs/index.php?project=1&amp;do=index">Tasklist</a>
    </span>

  <h2 class="summary severity1">
	 FS#385 - passing keypresses to a client  </h2>

  <div id="fineprint">
	 Attached to Project:
	 <a href="/bugs/index.php?project=1">awesome</a>
	 <br />
	 Opened by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=190">koniu (koniu)</a>     	 - Sunday, 23 November 2008, 19:32 GMT 	 	 <br />
	 Last edited by  <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=1">Julien Danjou (jd)</a>	 - Monday, 29 December 2008, 16:27 GMT 	   </div>

  <table><tr><td id="taskfieldscell">
  <div id="taskfields">
	 <table>
		<tr>
		  <th id="tasktype">Task Type</th>
		  <td headers="tasktype">Feature Request</td>
		</tr>
		<tr>
		  <th id="category">Category</th>
		  <td headers="category">
			 			 Core		  </td>
		</tr>
		<tr>
		  <th id="status">Status</th>
		  <td headers="status">
			 			 Closed			 		  </td>
		</tr>
		<tr>
		  <th id="assignedto">Assigned To</th>
		  <td headers="assignedto">
			 			 No-one			 		  </td>
		</tr>
		<tr>
		  <th id="os">Operating System</th>
		  <td headers="os">All</td>
		</tr>
		<tr>
		  <th id="severity">Severity</th>
		  <td headers="severity">Very Low</td>
		</tr>
		<tr>
		  <th id="priority">Priority</th>
		  <td headers="priority">Normal</td>
		</tr>
		<tr>
		  <th id="reportedver">Reported Version</th>
		  <td headers="reportedver">git/master</td>
		</tr>
		<tr>
		  <th id="dueversion">Due in Version</th>
		  <td headers="dueversion">
			 			 Undecided			 		  </td>
		</tr>
		<tr>
		  <th id="duedate">Due Date</th>
		  <td headers="duedate">
			 Undecided		  </td>
		</tr>
		<tr>
		  <th id="percent">Percent Complete</th>
		  <td headers="percent">
			 <img src="https://awesomewm.org/bugs/themes/Bluey/percent-100.png"
				title="100% complete"
				alt="100%" />
		  </td>
		</tr>
        <tr class="votes">
		  <th id="votes">Votes</th>
		  <td headers="votes">
                    <a href="javascript:showhidestuff('showvotes')">3 </a>
          <div id="showvotes" class="hide">
              <ul class="reports">
                              <li><a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=209">Maarten Maathuis (madman2003)</a> (2008-11-28)</li>
                              <li><a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=190">koniu (koniu)</a> (2008-11-23)</li>
                              <li><a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=91">Ji?í Procházka (ojirio)</a> (2008-11-23)</li>
                            </ul>
          </div>
                              </td>
        </tr>
        <tr>
		  <th id="private">Private</th>
		  <td headers="private">
                        No            
                      </td>
        </tr>
        	 </table>
  </div>

  </td><td>

  <div id="taskdetailsfull">
	 <h3 class="taskdesc">Details</h3>
     <div id="taskdetailstext">Hello,<br />
<br />
It would be very very very useful if something like this was possible:<br />
<br />
keybinding(<br />
   { modkey }, &quot;t&quot;, <br />
   function()<br />
       awful.client.keypress({ &quot;Control&quot; }, &quot;t&quot;) <br />
   end<br />
):add()<br />
<br />
Function keypress() would probably take 2 arguments, analogous to first 2 arguments of keybinding() but instead of running a function it would send that key combination to the client.<br />
<br />
This, combined with client class matching, would allow awesome user to basically re-map all client shortcuts with rc.lua keybindings therefore making full shortcut unification possible.</div>

       
  </div>

  </td></tr></table>

  <div id="taskinfo">
	 <div id="taskdeps">
		<b>This task depends upon</b>
		<br />
		
		<br class="DoNotPrint" />

		
			 </div>

	 <div id="taskblocks">
        			 </div>
  </div>

    <div id="taskclosed">
      Closed by&nbsp;&nbsp;<a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=1">Julien Danjou (jd)</a><br />
      Monday, 29 December 2008, 16:27 GMT <br />
      <strong>Reason for closing:</strong> &nbsp;Implemented<br />
            <strong>Additional comments about closing:</strong> &nbsp;commit
d6dbb00f101789b690101ba44fadc4c0504b7cb2
<br />
Author: Julien Danjou
&lt;julien@danjou.info&gt;<br />
Date:   Mon Dec 29 17:03:17 2008
+0100<br />
<br />
    client: add support for input
faking<br />
    <br />
    This is done using XTest
extension.<br />
    <br />
    Signed-off-by: Julien Danjou
&lt;julien@danjou.info&gt;<br />        </div>
  
  <div id="actionbuttons">
	 
	 
	 	   </div>
</div>
<ul id="submenu">
    <li id="commentstab">
  <a href="#comments">Comments (2)</a>
  </li>
  
  <li id="relatedtab">
  <a href="#related">Related Tasks (0/0)</a>
  </li>

  
  </ul>
<div id="comments" class="tab">
    <em>
    <a name="comment912" id="comment912"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=385#comment912">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=190">koniu (koniu)</a> -
    Sunday, 23 November 2008, 20:16 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">jd, please skim through this if you can.<br />
<br />
19:11 &lt; ojirio&gt; if I wanted to catch x events from xserver to apps and manipulate them, how would I do it? that is basically what wm does, right?<br />
19:13 &lt; ojirio&gt; I basically want to make a general keyboard shortcuts - unified for all apps I use<br />
19:14 &lt; Evanlec&gt; ah yep, configure that through your window manager<br />
19:14 &lt; koniu&gt; ah yeah, jd_ needs to add passing keybindings to clients<br />
19:15 &lt; Evanlec&gt; that too<br />
19:15 &lt; koniu&gt; if that was possible, it would be very easy to have any sort of keybinding for anything in awesome<br />
19:17 &lt; lwi&gt; xbindkeys<br />
19:17 &lt; lwi&gt; xmodmap<br />
19:17 &lt; lwi&gt; etc.<br />
19:18 &lt; koniu&gt; on lowlevel i think xcb should make it easy to implement<br />
19:18 &lt; koniu&gt; if i understand what xcb is :P<br />
19:19 &lt; stillunknown&gt; ojirio: You want to change keypresses going to an application?<br />
19:19 &lt; ojirio&gt; well I specifically need to catch the keyboard and mouse events and depending on them and the application with focus do some action (generate another events for example) or just let the events through<br />
19:22 &lt; stillunknown&gt; ojirio: You certainly can&#039;t add a 2nd window manager.<br />
19:24 &lt; ojirio&gt; stillunknown: and make this app launch a wm as subprocess?<br />
19:25 &lt; stillunknown&gt; You can only have one window manager period.<br />
19:26 &lt; stillunknown&gt; For some really special case some kind of nested xserver might do, but not if you want to do it for all applications.<br />
19:36 &lt; koniu&gt; i added a req to flyspray to do this in awesome<br />
19:38 &lt; koniu&gt;<a href=" http://awesome.naquadah.org/bugs/index.php?do=details&amp;task_id=385"> http://awesome.naquadah.org/bugs/index.php?do=details&amp;task_id=385</a><br />
19:40 &lt; lwi&gt; koniu: if i get it right, just add the keybinding and check with client.focus what to do, isnt it that simple?<br />
19:41 &lt; ojirio&gt; koniu: wouldn&#039;t be better to ba able to send any x event?<br />
19:41 &lt; koniu&gt; well you match client.class / instance or whatever<br />
19:41 &lt; koniu&gt; ojirio: ultimately yes but a higher level function would be nice enough for me<br />
19:42 &lt; koniu&gt; what else would u send xevents for?<br />
19:42 &lt; koniu&gt; custom ones that is<br />
19:43 &lt; koniu&gt; (obviously it&#039;d be best to have both regardless =)<br />
19:44 &lt; stillunknown&gt; ojirio: some events will always be hidden behind capi functions<br />
19:44 &lt; stillunknown&gt; (sending arbitrary crap at clients is not a good idea)<br />
19:44 &lt; ojirio&gt; koniu: well Id like to record some macros of xevents (mouse&amp;keyboard) and then import them there<br />
19:45 &lt; koniu&gt; stillunknown: well they&#039;re implemented through higher level functions but there&#039;s no reason not to allow crafted xevents to be inserted too<br />
19:45 &lt; ojirio&gt; another thing - it could be used for mouse gestures but thats feature I do not use<br />
19:46 &lt; koniu&gt; ojirio: that afaik has some support in current awesome-git branch &#039;next&#039;<br />
19:46 &lt; stillunknown&gt; koniu: people should never see X protocol at the lua side imo<br />
19:46 &lt; stillunknown&gt; always an abstraction that is better suited to awesome<br />
19:47 &lt; koniu&gt; stillunknown: they don&#039;t have to because everything is high level functions<br />
19:47 &lt; koniu&gt; but if they choose to because they&#039;re aware of it and maybe know what they&#039;re doing or don&#039;t mind breaking their config then they should be allowed the opportunity<br />
19:48 &lt; stillunknown&gt; koniu: awesome turns it into that, but it wouldn&#039;t be if you exposed xcb 1:1<br />
19:48 &lt; koniu&gt; without having to learn c<br />
19:48 &lt; stillunknown&gt; You have no idea how bad having direct protocol access would be.<br />
19:48 &lt; koniu&gt; potentially yes<br />
19:48 &lt; koniu&gt; but also potentially VERY useful<br />
19:49 &lt; koniu&gt; that&#039;s the deal with freedom my friend<br />
19:49 &lt; stillunknown&gt; And completely bypasses awesome&#039;s high level structures.<br />
19:49 &lt; stillunknown&gt; making it confusing, inconsistent and ackward<br />
19:49 &lt; koniu&gt; has two sides - from and to, one removes limitations, the other imposes responsibility<br />
19:49 &lt; koniu&gt; stillunknown: how does it bypass them?<br />
19:50 &lt; koniu&gt; i&#039;d say it complements them<br />
19:51 &lt; stillunknown&gt; a screen in awesome doesn&#039;t neccesarily mean the same in x proto<br />
19:51 &lt; stillunknown&gt; for example<br />
19:51 &lt; koniu&gt; so it would be up to the user using it to distinct it<br />
19:51 &lt; koniu&gt; what&#039;s the big deal<br />
19:51 &lt; stillunknown&gt; many events are really not meant to be sent in certain situations<br />
19:52 &lt; koniu&gt; eh...<br />
19:52 &lt; stillunknown&gt; You&#039;re supposed to be shielded from doing that, otherwise you might as well make lua xcb bindings.<br />
19:52 &lt; koniu&gt; ok, i forgot who i was talking to<br />
19:52 &lt; farhaven&gt; uhm, i just wanted to give my two cents<br />
19:52 &lt; stillunknown&gt; as in?<br />
19:52 &lt; koniu&gt; i don&#039;t really know how awesome-&gt;xcb-&gt;x projects<br />
19:52 &lt; farhaven&gt; you can already send stuff to the xserver via xtest<br />
19:54 &lt; stillunknown&gt; koniu: just be happy with the nice abstraction you get from jd_ ;-)<br />
19:54 &lt; koniu&gt; it&#039;s limited<br />
19:54 &lt; koniu&gt; like the bug i just opened<br />
19:54 &lt; koniu&gt; that should be there no question asked<br />
19:54 &lt; stillunknown&gt; Then that&#039;s something to be implemented.<br />
19:55 &lt; stillunknown&gt; But certainly no reason to expose the underlying stuff completely.<br />
19:55 &lt; koniu&gt; should be really simple as far as i can imagine<br />
19:55 &lt; koniu&gt; no but it points to the issue of allowing maximal customization at the same time<br />
19:56 &lt; koniu&gt; so maybe in very conditional circumstances it will be necessary for sb to send an event<br />
19:56 &lt; stillunknown&gt; koniu: eventually it&#039;ll get done, awesome will slowly grow to it&#039;s end form<br />
19:56 &lt; koniu&gt; but 1ce again that probably would be best on xcb 1:1 with awsome<br />
19:56 &lt; koniu&gt; but i don&#039;t know how limited xcb is<br />
19:56 &lt; stillunknown&gt; xcb is not limited<br />
19:57 &lt; koniu&gt; so scratch xevent, xcb-wheteveryoucallit<br />
19:57 &lt; koniu&gt; give pretty much raw access to that<br />
19:57 &lt; stillunknown&gt; But it&#039;s too low level to be safely exposed.<br />
19:58 &lt; koniu&gt; hmmm, i&#039;m want to know what jd thinks :P<br /></div></div>

  
    <em>
    <a name="comment913" id="comment913"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=385#comment913">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=91">Ji?í Procházka (ojirio)</a> -
    Sunday, 23 November 2008, 21:05 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">following conversation (shortened):<br />
<br />
[21:25] [ ojirio] koniu: there must be way to forward events from wm to client<br />
[21:26] [ koniu] ojirio: you mean when using something like xte/xtest/xdotool ?<br />
[21:30] [ ojirio] koniu: no... that would be caught again by the wm<br />
[21:30] [ ojirio] you need to modify the wm code<br />
[21:31] [ koniu] ojirio: you could _maybe_ work around that in lua (in case of awesome)<br />
[21:31] [ koniu] i guess you couldnt without running a global keygrabber<br />
[21:32] [ koniu] yeah anyway, i hope jd will pick that bug up and implement this<br />
[21:34] [ ojirio] and I hope he would make it as new function that makes the output key <br />
                  events start from awesome in the event dataflow<br />
[21:34] [ ojirio] could you paste this too please? ;)<br />
[21:39] [ ojirio] koniu: you think there is any chance it could make it into the 3.1 <br />
                  final release? :)<br />
[21:45] [ koniu] ojirio: i have no idea, its not up to me. if you really care about it <br />
                 then add your comments to the bug and click &#039;add vote&#039; :)<br />
<br />
I would really love to be able to do this in lua config - I plan to build a database of shortcuts/macros with this to unify the interface of my system.</div></div>

  
  
  </div>
<div id="related" class="tab">
  <table>    <tr><td>
    <form method="post" action="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=385#related" >
        <table id="tasks_related" class="userlist">
        <tr>
          <th>
            <a href="javascript:ToggleSelected('tasks_related')">
              <img title="Toggle Selected" alt="Toggle Selected" src="https://awesomewm.org/bugs/themes/Bluey/kaboodleloop.png" width="16" height="16" />
            </a>
          </th>
          <th>Tasks related to this task (0)</th>
        </tr>
                <tr>
          <td colspan="2">
            <input type="hidden" name="action" value="remove_related" />
            <input type="hidden" name="task_id" value="385" />
            <button type="submit">Remove</button>
          </td>
        </tr>
        </table>
    </form>
    </td><td>
    
    <table id="duplicate_tasks" class="userlist">
        <tr>
          <th>Duplicate tasks of this task (0)</th>
        </tr>
            </table>
    </td></tr>
  </table>

  </div>
<div id="history" class="tab">
  <h3>Loading...</h3>
</div>
    </div>
    <p id="footer">
       <!-- Please don't remove this line - it helps promote Flyspray -->
       <a href="http://flyspray.org/" class="offsite">Powered by Flyspray</a>
    </p>
  </div>
  </body>
</html>
