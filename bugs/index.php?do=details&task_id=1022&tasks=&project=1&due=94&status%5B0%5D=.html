<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-AU" xml:lang="en-AU">
  <head>
    <title>FS#1022 : Moving terminal windows around usually makes them narrower</title>

    <meta name="description" content="Flyspray, a Bug Tracking System written in PHP." />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript" />
    <meta http-equiv="Content-Style-Type" content="text/css" />

    <link rel="icon" type="image/png" href="https://awesomewm.org/bugs/themes/Bluey/favicon.ico" />
    <link rel="index" id="indexlink" type="text/html" href="https://awesomewm.org/bugs/" />
        <link media="screen" href="https://awesomewm.org/bugs/themes/Bluey/theme.css" rel="stylesheet" type="text/css" />
    <link media="print"  href="https://awesomewm.org/bugs/themes/Bluey/theme_print.css" rel="stylesheet" type="text/css" />
    <link rel="alternate" type="application/rss+xml" title="Flyspray RSS 1.0 Feed"
          href="https://awesomewm.org/bugs/feed.php?feed_type=rss1&amp;project=1" />
    <link rel="alternate" type="application/rss+xml" title="Flyspray RSS 2.0 Feed"
          href="https://awesomewm.org/bugs/feed.php?feed_type=rss2&amp;project=1" />
	<link rel="alternate" type="application/atom+xml" title="Flyspray Atom 0.3 Feed"
	      href="https://awesomewm.org/bugs/feed.php?feed_type=atom&amp;project=1" />

    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/prototype/prototype.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/script.aculo.us/scriptaculous.js"></script>
            <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/details.js"></script>
                <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/tabs.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/functions.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/jscalendar/calendar_stripped.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/jscalendar/calendar-setup_stripped.js"> </script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/jscalendar/lang/calendar-en.js"></script>
    <script type="text/javascript" src="https://awesomewm.org/bugs/javascript/lightbox/js/lightbox.js"></script>
    <link rel="stylesheet" href="https://awesomewm.org/bugs/javascript/lightbox/css/lightbox.css" type="text/css" media="screen" />
    <!--[if IE]>
    <link media="screen" href="https://awesomewm.org/bugs/themes/Bluey/ie.css" rel="stylesheet" type="text/css" />
    <![endif]-->
      </head>
  <body onload="perms = new Perms('permissions');">

  <div id="container">
    <!-- Remove this to remove the logo -->
    <h1 id="title"><a href="https://awesomewm.org/bugs/">awesome</a></h1>

    <div id="menu">

<form id="login" action="https://awesomewm.org/bugs/index.php?do=authenticate" method="post">
<div>
  <label for="lbl_user_name">Username</label>
  <input class="text" type="text" id="lbl_user_name" name="user_name" size="17" maxlength="30" />

  <label for="lbl_password">Password</label>
  <input class="password" type="password" id="lbl_password" name="password" size="17" maxlength="30" />

  <label for="lbl_remember">Remember me</label>
  <input type="checkbox" id="lbl_remember" name="remember_login" />
  
  <input type="hidden" name="return_to" value="/bugs/index.php?do=details&amp;task_id=1022&amp;tasks=&amp;project=1&amp;due=94&amp;status%5B0%5D=" />

  <button accesskey="l" type="submit">Login!</button>

  <span id="links">
            <a id="forgotlink" href="https://awesomewm.org/bugs/index.php?do=lostpw">Lost password?</a>
      </span>
</div>
</form>
</div>

<div id="pm-menu">

<div id="projectselector">
    <form id="projectselectorform" action="https://awesomewm.org/bugs/index.php" method="get">
       <div>
        <select name="project" onChange="document.getElementById('projectselectorform').submit()">
          <option value="0">All Projects</option>        </select>
        <button type="submit">Switch</button>
        <input type="hidden" name="do" value="details" />
        <input type="hidden" value="1" name="switch" />
              </div>
    </form>
</div>

<ul id="pm-menu-list">
    <li class="first">
      <a id="toplevellink" href="https://awesomewm.org/bugs/index.php?do=toplevel&amp;project=1">Overview</a>
    </li>

    <li>
    <a id="homelink"
        href="https://awesomewm.org/bugs/index.php?project=1&amp;do=index">Tasklist</a>
    </li>

    
    
        <li>
    <a id="roadmaplink"
        href="https://awesomewm.org/bugs/index.php?do=roadmap&amp;project=1">Roadmap</a>
    </li>
    
    
    </ul>
</div>

    
    <div id="content">
      <div id="showtask">
        <form action="https://awesomewm.org/bugs/index.php" method="get">
          <div>
            <button type="submit">Show Task #</button>
            <input id="taskid" name="show_task" class="text" type="text" size="10" accesskey="t" />
          </div>
        </form>
      </div>

      <div class="clear"></div>
            <div id="intromessage">Welcome to awesome bug tracking system.</div>
      <div id="taskdetails">
<span id="navigation">       <a href="https://awesomewm.org/bugs/index.php?project=1&amp;do=index&amp;tasks=&amp;due=94&amp;status%5B0%5D=">Tasklist</a>
    </span>

  <h2 class="summary severity2">
	 FS#1022 - Moving terminal windows around usually makes them narrower  </h2>

  <div id="fineprint">
	 Attached to Project:
	 <a href="/bugs/index.php?project=1">awesome</a>
	 <br />
	 Opened by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=1">Julien Danjou (jd)</a>     	 - Tuesday, 17 July 2012, 11:42 GMT 	 	 <br />
	 Last edited by  <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a>	 - Thursday, 13 March 2014, 12:29 GMT 	   </div>

  <table><tr><td id="taskfieldscell">
  <div id="taskfields">
	 <table>
		<tr>
		  <th id="tasktype">Task Type</th>
		  <td headers="tasktype">Bug Report</td>
		</tr>
		<tr>
		  <th id="category">Category</th>
		  <td headers="category">
			 			 Lua libraries &#8594;
			 			 awful		  </td>
		</tr>
		<tr>
		  <th id="status">Status</th>
		  <td headers="status">
			 			 Closed			 		  </td>
		</tr>
		<tr>
		  <th id="assignedto">Assigned To</th>
		  <td headers="assignedto">
			 			 No-one			 		  </td>
		</tr>
		<tr>
		  <th id="os">Operating System</th>
		  <td headers="os">All</td>
		</tr>
		<tr>
		  <th id="severity">Severity</th>
		  <td headers="severity">Low</td>
		</tr>
		<tr>
		  <th id="priority">Priority</th>
		  <td headers="priority">Normal</td>
		</tr>
		<tr>
		  <th id="reportedver">Reported Version</th>
		  <td headers="reportedver">git/3.5</td>
		</tr>
		<tr>
		  <th id="dueversion">Due in Version</th>
		  <td headers="dueversion">
			 			 3.5.3			 		  </td>
		</tr>
		<tr>
		  <th id="duedate">Due Date</th>
		  <td headers="duedate">
			 Undecided		  </td>
		</tr>
		<tr>
		  <th id="percent">Percent Complete</th>
		  <td headers="percent">
			 <img src="https://awesomewm.org/bugs/themes/Bluey/percent-100.png"
				title="100% complete"
				alt="100%" />
		  </td>
		</tr>
        <tr class="votes">
		  <th id="votes">Votes</th>
		  <td headers="votes">
                    <a href="javascript:showhidestuff('showvotes')">2 </a>
          <div id="showvotes" class="hide">
              <ul class="reports">
                              <li><a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=879">Sylvestre Ledru (sylvestre)</a> (2013-10-30)</li>
                              <li><a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=917">Eugen Dedu (Eugen Dedu)</a> (2013-10-30)</li>
                            </ul>
          </div>
                              </td>
        </tr>
        <tr>
		  <th id="private">Private</th>
		  <td headers="private">
                        No            
                      </td>
        </tr>
        	 </table>
  </div>

  </td><td>

  <div id="taskdetailsfull">
	 <h3 class="taskdesc">Details</h3>
     <div id="taskdetailstext">Copy of<a href=" http://bugs.debian.org/cgi-bin/bugreport.cgi?archive=yes&amp;bug=681770"> http://bugs.debian.org/cgi-bin/bugreport.cgi?archive=yes&amp;bug=681770</a><br />
<br />
I use awesome in the stock configuration. When opening a terminal<br />
window, then move it around (Mod4 + Button1), the window<br />
typically gets narrower at a rate of around 10-15 columns per second<br />
until the mouse button is being released. This happens for roxterm and<br />
gnome-terminal in any case, but does not seem to affect xterm and<br />
konsole. It happens most of the time, and resizing the window first<br />
reduces the chances of this automatic resizing by awesome.<br />
<br />
This is annoying, but not a showstopper.<br /></div>

       
  </div>

  </td></tr></table>

  <div id="taskinfo">
	 <div id="taskdeps">
		<b>This task depends upon</b>
		<br />
		
		<br class="DoNotPrint" />

		
			 </div>

	 <div id="taskblocks">
        			 </div>
  </div>

    <div id="taskclosed">
      Closed by&nbsp;&nbsp;<a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a><br />
      Thursday, 13 March 2014, 12:29 GMT <br />
      <strong>Reason for closing:</strong> &nbsp;Won&#039;t fix<br />
            <strong>Additional comments about closing:</strong> &nbsp;Bug is in roxterm        </div>
  
  <div id="actionbuttons">
	 
	 
	 	   </div>
</div>
<ul id="submenu">
    <li id="commentstab">
  <a href="#comments">Comments (20)</a>
  </li>
  
  <li id="relatedtab">
  <a href="#related">Related Tasks (0/1)</a>
  </li>

  
  </ul>
<div id="comments" class="tab">
    <em>
    <a name="comment3123" id="comment3123"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3123">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a> -
    Tuesday, 17 July 2012, 14:57 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">Anyone can reproduce? (Other questions I better mail to the debian BTS)</div></div>

  
    <em>
    <a name="comment3124" id="comment3124"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3124">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=728">David Ewing (ewingd)</a> -
    Tuesday, 17 July 2012, 15:15 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">I have been having an issue with terminal windows resizing during movement as well.  I am see it with gnome-terminal and the window gets shorter during movement until it reaches as height of 3 lines.  It only seems to happen once when the terminal is initially opened on a tag set to the floating layout.  It also seems to stop after resizing the window.  I am seeing this on Debian Wheezy.<br />
<br />
$ awesome --version<br />
awesome debian/3.4.12-2 (Starlight)<br />
 • Build: Jun 13 2012 11:30:57 for x86_64 by gcc version 4.7.0 (@zelenka)<br />
 • D-Bus support: ✔<br /></div></div>

  
    <em>
    <a name="comment3125" id="comment3125"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3125">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a> -
    Tuesday, 17 July 2012, 20:18 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">Ok, first observation: The alternative systems thinks I want to use roxterm instead of urxvt just because I installed it. Meh.<br />
<br />
Doesn&#039;t happen on git/master (suddenly I care a lot less) and on 3.4, it happens somewhere in the middle of nowhere.<br />
<br />
I added some print() calls to awful.mouse. It calls c:geometry() with the old width and height, so nothing should get changed here. So I guess that the C code now screws up somewhere while it tries to apply size hints to this unchanged size.<br />
Also, checking with xwininfo/xprop, it looks like the current size of the window doesn&#039;t respect its size hints, although it should.<br />
So at this point, I&#039;d have to add printf()s to the source code and since I can&#039;t compile 3.4, I&#039;m giving up here. Also, no idea what xterm does differently (perhaps its initial size respects its size hints?).</div></div>

  
    <em>
    <a name="comment3733" id="comment3733"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3733">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=917">Eugen Dedu (Eugen Dedu)</a> -
    Wednesday, 30 October 2013, 10:09 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">I reproduce it too, using 3.5.1, using vanilla rc.lua from debian.  Is there anything simple I can do to help fix this bug?<br />
<br />
Note that not the number of columns is shrinking, but the number of lines.</div></div>

  
    <em>
    <a name="comment3734" id="comment3734"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3734">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a> -
    Wednesday, 30 October 2013, 16:04 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext"><del>&#160;<a href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1165&amp;tasks=&amp;project=1&amp;due=94&amp;status%5B0%5D=" title="Duplicate | Moving gnome-terminal decreases its size | 100%"  class = "closedtasklink">FS#1165</a>&#160;</del> is a duplicate of this.</div></div>

  
    <em>
    <a name="comment3743" id="comment3743"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3743">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=917">Eugen Dedu (Eugen Dedu)</a> -
    Wednesday, 13 November 2013, 14:24 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">Uli, do you need a video showing this issue?  It is really annoying...</div></div>

  
    <em>
    <a name="comment3744" id="comment3744"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3744">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a> -
    Wednesday, 13 November 2013, 16:47 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">I don&#039;t need a video, I need someone to tell me how to reproduce this myself. According to my comment from july, this does not happen here.</div></div>

  
    <em>
    <a name="comment3756" id="comment3756"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3756">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=917">Eugen Dedu (Eugen Dedu)</a> -
    Saturday, 23 November 2013, 09:07 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">I tried putting some print() in various lua files in /usr/share/awesome/lib/awful, but have not seen anything useful.<br />
<br />
It seems to me that print() is asynchronous (I used it with tail -f .xsession-errors, and messages appear a few seconds later it seems), how to make it synchronous?<br />
<br />
Also, this could be specific to floating layout, have you tried this layout during your tests?</div></div>

  
    <em>
    <a name="comment3765" id="comment3765"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3765">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=679">Alexander Yakushev (Alex.yakushev)</a> -
    Saturday, 07 December 2013, 13:46 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">Arch Linux, awesome 3.5.1, can&#039;t reproduce unfortunately.</div></div>

  
    <em>
    <a name="comment3771" id="comment3771"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3771">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=917">Eugen Dedu (Eugen Dedu)</a> -
    Saturday, 21 December 2013, 00:02 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">I have just installed 3.5.2.  The bug is still there, but whereas with 3.5.1 when I moved the terminal the windows was continously shrinking to show only 1-2 lines, with 3.5.2 it shrinks (much slower) by 1-2 lines each 10-20 pixels of movement, so if I move it only a bit, it shrinks only a bit...</div></div>

  
    <em>
    <a name="comment3772" id="comment3772"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3772">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=931">Rick Klomp (Rick)</a> -
    Saturday, 21 December 2013, 10:15 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">I&#039;ve experienced this issue aswell but only with roxterm, not with xterm. I&#039;m using version 3.5.2.<br />
<br />
Once I&#039;d resize roxterm myself (with the right mouse button), I could move roxterm without it being resized anymore.</div></div>

  
    <em>
    <a name="comment3773" id="comment3773"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3773">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=917">Eugen Dedu (Eugen Dedu)</a> -
    Saturday, 21 December 2013, 15:06 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">The same is for me!</div></div>

  
    <em>
    <a name="comment3874" id="comment3874"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3874">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=494">Daniel Hahler (blueyed)</a> -
    Wednesday, 12 March 2014, 00:17 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">Can you still reproduce this using Git master?<br />
<br />
Also, it sounds like window borders might be involved here (given the amount of shrinking happening). Also, you might want to test it with/without titlebars enabled.<br />
<br />
Given the last two comments, where resizing the window first fixes it, it might also be related to honoring size hints? (http://awesome.naquadah.org/wiki/FAQ#How_to_remove_gaps_between_windows.3F).</div></div>

  
    <em>
    <a name="comment3875" id="comment3875"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3875">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=494">Daniel Hahler (blueyed)</a> -
    Wednesday, 12 March 2014, 00:19 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">The bug in Launchpad (for awesome in Ubuntu, 3.4.x;<a href=" https://bugs.launchpad.net/ubuntu/+source/awesome/+bug/872876"> https://bugs.launchpad.net/ubuntu/+source/awesome/+bug/872876</a>) mentions these workarounds:<br />
 - resize the window before you drag it around (Win+RMB-Drag)<br />
 - resize the window to a size that is odd to the height of a character<br />
 - when there is a bit space in the bottom of the window (clientheight is not a multiple of the height of one line), moving will work correctly</div></div>

  
    <em>
    <a name="comment3886" id="comment3886"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3886">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a> -
    Thursday, 13 March 2014, 12:29 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">So since I bet someone will reopen this, I&#039;ll write this here:<br />
<br />
roxterm is breaking ICCCM, just like <del>&#160;<a href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1214&amp;tasks=&amp;project=1&amp;due=94&amp;status%5B0%5D=" title="Not a bug | Fullscreen with LilyTerm, awesome titlebar and specific font (Ub | 100%"  class = "closedtasklink">FS#1214</a>&#160;</del> is.<br />
<br />
The code is here:<br />
<br /><a href="
http://sourceforge.net/p/roxterm/code/ci/master/tree/src/roxterm.c">
http://sourceforge.net/p/roxterm/code/ci/master/tree/src/roxterm.c</a><br />
<br />
roxterm_resize_window_handler() gets called when the roxterm window is resized. This can call into roxterm_set_vte_size() which can then call gtk_window_resize(). So basically this is a violation of ICCCM § 4.2.4<br />
<br />
(Of course there must still be a bug somewhere that causes awesome and roxterm to interpret the size hints differently and thus causing the resize loop. However, ICCCM mandates that the WM is always right when resizing windows!)</div></div>

  
    <em>
    <a name="comment3896" id="comment3896"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3896">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=917">Eugen Dedu (Eugen Dedu)</a> -
    Friday, 14 March 2014, 09:35 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">Just to say that for me the problem appears with gnome-terminal.</div></div>

  
    <em>
    <a name="comment3897" id="comment3897"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3897">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=917">Eugen Dedu (Eugen Dedu)</a> -
    Friday, 14 March 2014, 09:38 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">With titlebar to false and awesome 3.5.2, I still have the same problem with gnome-terminal: I start it, I move it =&gt; number of lines shrinks.</div></div>

  
    <em>
    <a name="comment3900" id="comment3900"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3900">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a> -
    Friday, 14 March 2014, 10:27 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">As you wish:<br />
<br />
gnome-terminal-3.10.1/src/terminal-window.c. First we have:<br />
<br />
  g_signal_connect (screen, &quot;resize-window&quot;,<br />
                    G_CALLBACK (screen_resize_window_cb), window);<br />
<br />
From the name, it sounds like this callback gets called when the &quot;screen&quot; is resized. &quot;screen&quot; has type TerminalScreen*, &quot;window&quot; is a &quot;TerminalWindow&quot;, so I&#039;ll just assume that this gets called when the terminal is resized.<br />
<br />
Anyway, that callback then calculates some magic (and does nothing if the widget already has the size that it wants) and if the &quot;screen&quot; is the currently active screen, it calls terminal_window_update_size():<br />
<br />
static void<br />
terminal_window_update_size (TerminalWindow *window)<br />
{<br />
  TerminalWindowPrivate *priv = window-&gt;priv;<br />
  int grid_width, grid_height;<br />
<br />
  /* be sure our geometry is up-to-date */<br />
  terminal_window_update_geometry (window);<br />
<br />
  terminal_screen_get_size (priv-&gt;active_screen, &amp;grid_width, &amp;grid_height);<br />
<br />
  gtk_window_resize_to_geometry (GTK_WINDOW (window), grid_width, grid_height);<br />
}<br />
<br />
And once again we found a violation of ICCCM § 4.2.4. A client resizes itself in response to being resized. (= Awesome resized the window, gnome-terminal reacts by resizing itself to a smaller size, awesome&#039;s size hint computation kicks in and does a resize to a smaller size, gnome-terminal responds by requesting an even smaller size etc)</div></div>

  
    <em>
    <a name="comment3901" id="comment3901"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3901">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=917">Eugen Dedu (Eugen Dedu)</a> -
    Friday, 14 March 2014, 10:58 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">Interesting.  But your analysis deals with terminal resize, whereas the current bug is about *moving* the terminal.<br />
<br />
(I noticed some issues when resizing too in some cases, but this is another story.)<br />
<br />
Regarding the specification, when the user increases the height with a few pixels, what should be the new height of the terminal (knowing that it stores full-height lines of text)?</div></div>

  
    <em>
    <a name="comment3902" id="comment3902"
      href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#comment3902">
      <img src="https://awesomewm.org/bugs/themes/Bluey/comment.png"
        title="Link to this comment" alt="" />
    </a>
    Comment by <a href="https://awesomewm.org/bugs/index.php?do=user&amp;area=users&amp;id=289">Uli Schlachter (psychon)</a> -
    Friday, 14 March 2014, 12:41 GMT   </em>

  <span class="DoNotPrint">
    
      </span>
  <div class="comment">
    <div class="commenttext">Well, in X11 moving and resizing the a window is both done with a ConfigureWindow request and causes a ConfigureEvent to be delivered. I am just assuming that this triggers the same code path.<br />
<br />
And ICCCM apparently doesn&#039;t require WMs to honor size hints. The spec for WM_NORMAL_HINTS (§ 4.1.2.3) contains &quot;Window managers that honor aspect ratios should[...]&quot;. That sounds like not all WMs must do so. But I can&#039;t find a definitive answer (and the spec certainly doesn&#039;t say anything about terminal emulators).<br />
<br />
The only thing I know about is the second paragraph from § 4.2.4 (which isn&#039;t really useful advice):<br />
<br />
The response of the client to being resized should be to accept the size it has been given and to do its best with it. Clients must not respond to being resized by attempting to resize themselves to a better size. If the size is impossible to work with, clients are free to request to change to the Iconic state.<br /></div></div>

  
  
  </div>
<div id="related" class="tab">
  <table>    <tr><td>
    <form method="post" action="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1022#related" >
        <table id="tasks_related" class="userlist">
        <tr>
          <th>
            <a href="javascript:ToggleSelected('tasks_related')">
              <img title="Toggle Selected" alt="Toggle Selected" src="https://awesomewm.org/bugs/themes/Bluey/kaboodleloop.png" width="16" height="16" />
            </a>
          </th>
          <th>Tasks related to this task (0)</th>
        </tr>
                <tr>
          <td colspan="2">
            <input type="hidden" name="action" value="remove_related" />
            <input type="hidden" name="task_id" value="1022" />
            <button type="submit">Remove</button>
          </td>
        </tr>
        </table>
    </form>
    </td><td>
    
    <table id="duplicate_tasks" class="userlist">
        <tr>
          <th>Duplicate tasks of this task (1)</th>
        </tr>
                <tr><td><del>&#160;<a href="https://awesomewm.org/bugs/index.php?do=details&amp;task_id=1165&amp;tasks=&amp;project=1&amp;due=94&amp;status%5B0%5D=" title="Duplicate | Moving gnome-terminal decreases its size | 100%"  class = "closedtasklink">FS#1165 - Moving gnome-terminal decreases its size</a>&#160;</del></td></tr>
            </table>
    </td></tr>
  </table>

  </div>
<div id="history" class="tab">
  <h3>Loading...</h3>
</div>
    </div>
    <p id="footer">
       <!-- Please don't remove this line - it helps promote Flyspray -->
       <a href="http://flyspray.org/" class="offsite">Powered by Flyspray</a>
    </p>
  </div>
  </body>
</html>
