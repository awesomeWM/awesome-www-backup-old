<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>Woffles Volume Widget - awesome</title>
<meta name="generator" content="MediaWiki 1.24.2" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="/w/index.php?title=Woffles_Volume_Widget&amp;action=edit" />
<link rel="edit" title="Edit" href="/w/index.php?title=Woffles_Volume_Widget&amp;action=edit" />
<link rel="shortcut icon" href="/images/icons/aw_16.png" />
<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="awesome (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://awesomewm.org/w/api.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="/wiki/Woffles_Volume_Widget" />
<link rel="copyright" href="https://creativecommons.org/licenses/by/3.0/" />
<link rel="alternate" type="application/atom+xml" title="awesome Atom feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="canonical" href="/wiki/Woffles_Volume_Widget" />
<link rel="stylesheet" href="https://awesomewm.org/w/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.monobook.styles&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if IE 6]><link rel="stylesheet" href="/w/skins/MonoBook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/w/skins/MonoBook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="https://awesomewm.org/w/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: awesome:resourceloader:filter:minify-css:7:ad506c29508072131b881ff3f2f9d363 */</style>
<script src="https://awesomewm.org/w/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Woffles_Volume_Widget","wgTitle":"Woffles Volume Widget","wgCurRevisionId":1305,"wgRevisionId":1305,"wgArticleId":48,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Widgets","Awesome2"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Woffles_Volume_Widget","wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRedirectedFrom":"Volume_in_Status_Bar_(better)","wgInternalRedirectTargetUrl":"/wiki/Woffles_Volume_Widget"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"editfont":"default","editondblclick":0,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":1,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nickname":"","norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rows":25,"showhiddencats":0,"shownumberswatching":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":5,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":1,"watchdefault":1,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"watchrollback":0,
"wllimit":250,"useeditwarning":1,"prefershttps":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});},{},{});
/* cache key: awesome:resourceloader:filter:minify-js:7:ab52f6eb1652fbc58fa39bdfdc3926f5 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.redirect","mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Woffles_Volume_Widget skin-monobook action-view">
<div id="globalWrapper">
		<div id="column-content">
			<div id="content" class="mw-body" role="main">
				<a id="top"></a>
									<div id="siteNotice"><div id="localNotice" lang="en" dir="ltr"><p><b>This wiki will shut down!</b>
</p><p>Please note that this wiki will be made read-only and eventually be taken offline.
</p><p>A replacement is being discussed at <a rel="nofollow" class="external free" href="https://github.com/awesomeWM/awesome-www/issues/7">https://github.com/awesomeWM/awesome-www/issues/7</a>. We'd be happy to have more input for that discussion and volunteers who help us migrate the content of this wiki to its replacement.
</p></div></div>
				<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Woffles Volume Widget</span></h1>

				<div id="bodyContent" class="mw-body-content">
					<div id="siteSub">From awesome</div>
					<div id="contentSub">(Redirected from <a href="/w/index.php?title=Volume_in_Status_Bar_(better)&amp;redirect=no" title="Volume in Status Bar (better)">Volume in Status Bar (better)</a>)</div>
										<div id="jump-to-nav" class="mw-jump">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>

					<!-- start content -->
					<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Preparation"><span class="tocnumber">2</span> <span class="toctext">Preparation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Create_the_widget"><span class="tocnumber">3</span> <span class="toctext">Create the widget</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Create_the_scripts"><span class="tocnumber">4</span> <span class="toctext">Create the scripts</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Final_steps"><span class="tocnumber">5</span> <span class="toctext">Final steps</span></a></li>
</ul>
</div>

<h3><span class="mw-headline" id="Introduction">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Woffles_Volume_Widget&amp;action=edit&amp;section=1" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Having a usable volume control in my status bar was very important, I
needed to be able to adjust the volume if needed, or mute it quickly.
</p><p>By following this tutorial you'll end up with a widget in your status
bar that looks like "Volume: 50%" which responds to mouse actions:
</p>
<ul><li> Mouse wheel adjusts volume up / down.</li>
<li> Left clicking on the volume mutes it.</li></ul>
<p>This tutorial is aimed at systems using alsa, you'll need to confirm
that you have the following programs installed:
</p>
<ul><li> alsamixer -- Ncurses based volume control.</li>
<li> amixer -- Tool for adjusting alsa on the fly.</li>
<li> pcregrep -- grep using the PCRE syntax.</li></ul>
<h3><span class="mw-headline" id="Preparation">Preparation</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Woffles_Volume_Widget&amp;action=edit&amp;section=2" title="Edit section: Preparation">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Before we start we need to know which audio channel you want to control,
usually "Master" or "PCM". To get a list of available channels:
</p>
<pre>amixer -c 0 | pcregrep "control"
</pre>
<p>To test and make sure the value will do what we need run:
</p>
<pre>amixer -c 0 -- sget Master | pcregrep "[0-9]+%"
</pre>
<p>The output should look like:
</p>
<pre>Front Left: Playback 6 [19%] [-37.50dB] [on]
Front Right: Playback 6 [19%] [-37.50dB] [on]
</pre>
<p><i>Note: Your card ID (the -c 0 bit) might be different if you have</i>
more than one sound card available.
</p>
<h3><span class="mw-headline" id="Create_the_widget">Create the widget</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Woffles_Volume_Widget&amp;action=edit&amp;section=3" title="Edit section: Create the widget">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Put this in whichever status bar you want them:
</p>
<pre>textbox volume_control {
	text_align = "right"
	align = "right"
	
	# Volume up:
	mouse {
		modkey = {}
		button = "4"
		command = "spawn"
		arg = "~/.awesome/volume-adjust.sh up"
	}
	
	# Volume down:
	mouse {
		modkey = {}
		button = "5"
		command = "spawn"
		arg = "~/.awesome/volume-adjust.sh down"
	}
	
	# Soft mute:
	mouse {
		modkey = {}
		button = "1"
		command = "spawn"
		arg = "~/.awesome/volume-adjust.sh mute"
	}
}
</pre>
<h3><span class="mw-headline" id="Create_the_scripts">Create the scripts</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Woffles_Volume_Widget&amp;action=edit&amp;section=4" title="Edit section: Create the scripts">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The first shell script we make simply contains the values of our card ID
, the name of the channel we want to control, the percent of adjustment
we want when using the mouse wheel, the name of the widget to update and
finally the speed to update at in seconds:
</p><p><b>~/.awesome/volume-values.sh:</b>
</p>
<pre>handle() {
	# Hard mute:
	if [ "$1" == "0" ]
	then
		`amixer -c $cardid sset $channel mute &gt; /dev/null`
	else
		`amixer -c $cardid sset $channel unmute &gt; /dev/null`
	fi
	
	# Set widget text:
	echo " Volume: $1% "
}

cardid=0
channel="Master"
adjust=5
widget="volume_control"
speed=10
</pre>
<p>If you don't have an <i>~/.awesome</i> folder, feel free to create one (~
is equal to your home directory.)
</p><p>If you find that updating once every 10 seconds (<i>speed=10</i>) isn't
enough feel free to change the value. Just be warned however that the
smaller the value the higher your CPU usage will get.
</p><p>Next we create a script to update the awesome widget:
</p><p><b>~/.awesome/volume-update.sh:</b>
</p>
<pre>. ~/.awesome/volume-values.sh

volume=`amixer -c $cardid -- sget $channel | pcregrep 'Left:.+[0-9]+%' | pcregrep -o '[0-9]+%' | pcregrep -o '[0-9]+'`

echo "0 widget_tell $widget `handle \"$volume\"`" | awesome-client
</pre>
<p>Now we need a script to handle the volume adjustment:
</p><p><b>~/.awesome/volume-adjust.sh:</b>
</p>
<pre>. ~/.awesome/volume-values.sh

if [ "$1" == "up" ]
then
	amixer -q -c $cardid sset $channel $adjust%+
fi

if [ "$1" == "down" ]
then
	amixer -q -c $cardid sset $channel $adjust%-
fi

if [ "$1" == "mute" ]
then
	amixer -q -c $cardid sset $channel 0%
fi

# Force awesome to update:
~/.awesome/volume-update.sh
</pre>
<p>And finally we need a script to monitor the volume, in case another
program changes it:
</p><p><b>~/.awesome/volume-monitor.sh:</b>
</p>
<pre>while true
do
	if [ -S ~/.awesome_ctl.0 ]; then
		while true
		do
			. ~/.awesome/volume-update.sh
			
			sleep $speed
		done
	else
		sleep 1
	fi
done
</pre>
<p>To make sure the scripts can be executed run:
</p>
<pre>chmod +x ~/.awesome/volume-*
</pre>
<h3><span class="mw-headline" id="Final_steps">Final steps</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/w/index.php?title=Woffles_Volume_Widget&amp;action=edit&amp;section=5" title="Edit section: Final steps">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The last thing you need to do is find a way to automatically run
<i>~/.awesome/volume-monitor.sh</i> every time you start an X session.
</p><p>The usual way is to edit your <i>~/.xinitrc</i> file to include the script,
this might look something line:
</p>
<pre>~/.awesome/volume-monitor.sh &amp;
exec awesome
</pre>
<p>However, you'll probably need to figure something else out if you're
using a display manager like xdm, gdm or kdm.
</p><p>Finally, tell awesome to reload your configuration, the usual way is to
press <i>Control-Mod4-R</i>.
</p><p>That just about covers everything, if you have any question I'm
<i>woffle</i> on IRC.
</p>
<!-- 
NewPP limit report
CPU time usage: 0.016 seconds
Real time usage: 0.018 seconds
Preprocessor visited node count: 18/1000000
Preprocessor generated node count: 24/1000000
Postâ€expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key awesome:pcache:idhash:48-0!*!*!!en!*!* and timestamp 20160515070215 and revision id 1305
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://awesomewm.org/w/index.php?title=Woffles_Volume_Widget&amp;oldid=1305">https://awesomewm.org/w/index.php?title=Woffles_Volume_Widget&amp;oldid=1305</a>"</div>
					<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="/wiki/Category:Widgets" title="Category:Widgets">Widgets</a></li><li><a href="/wiki/Category:Awesome2" title="Category:Awesome2">Awesome2</a></li></ul></div></div>					<!-- end content -->
										<div class="visualClear"></div>
				</div>
			</div>
		</div>
		<div id="column-one">
			<h2>Navigation menu</h2>
					<div id="p-cactions" class="portlet" role="navigation">
			<h3>Views</h3>

			<div class="pBody">
				<ul>
				<li id="ca-nstab-main" class="selected"><a href="/wiki/Woffles_Volume_Widget" title="View the content page [c]" accesskey="c">Page</a></li>
				<li id="ca-talk" class="new"><a href="/w/index.php?title=Talk:Woffles_Volume_Widget&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				<li id="ca-edit"><a href="/w/index.php?title=Woffles_Volume_Widget&amp;action=edit" title="You can edit this page. Please use the preview button before saving [e]" accesskey="e">Edit</a></li>
				<li id="ca-history"><a href="/w/index.php?title=Woffles_Volume_Widget&amp;action=history" rel="archives" title="Past revisions of this page [h]" accesskey="h">History</a></li>
				</ul>
							</div>
		</div>
				<div class="portlet" id="p-personal" role="navigation">
				<h3>Personal tools</h3>

				<div class="pBody">
					<ul>
													<li id="pt-anonuserpage"><a href="/wiki/User:95.90.224.24" class="new" title="The user page for the IP address you are editing as [.]" accesskey=".">95.90.224.24</a></li>
													<li id="pt-anontalk"><a href="/wiki/User_talk:95.90.224.24" class="new" title="Discussion about edits from this IP address [n]" accesskey="n">Talk for this IP address</a></li>
													<li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=Woffles+Volume+Widget" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
											</ul>
				</div>
			</div>
			<div class="portlet" id="p-logo" role="banner">
				<a href="/wiki/Main_Page" style="background-image: url(/images/icons/aw_64.png);" title="Visit the main page"></a>
			</div>
				<div class="generated-sidebar portlet" id="p-navigation" role="navigation">
		<h3>Navigation</h3>
		<div class='pBody'>
							<ul>
											<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
											<li id="n-Homepage"><a href="http://awesome.naquadah.org" rel="nofollow">Homepage</a></li>
											<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
											<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
											<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
									</ul>
					</div>
		</div>
			<div id="p-search" class="portlet" role="search">
			<h3><label for="searchInput">Search</label></h3>

			<div id="searchBody" class="pBody">
				<form action="/w/index.php" id="searchform">
					<input type='hidden' name="title" value="Special:Search"/>
					<input type="search" name="search" placeholder="Search" title="Search awesome [f]" accesskey="f" id="searchInput" />
					<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
						<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
				</form>

							</div>
		</div>
			<div class="portlet" id="p-tb" role="navigation">
			<h3>Tools</h3>

			<div class="pBody">
				<ul>
											<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Woffles_Volume_Widget" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
											<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Woffles_Volume_Widget" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
											<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
											<li id="t-print"><a href="/w/index.php?title=Woffles_Volume_Widget&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
											<li id="t-permalink"><a href="/w/index.php?title=Woffles_Volume_Widget&amp;oldid=1305" title="Permanent link to this revision of the page">Permanent link</a></li>
											<li id="t-info"><a href="/w/index.php?title=Woffles_Volume_Widget&amp;action=info">Page information</a></li>
									</ul>
							</div>
		</div>
			</div><!-- end of the left (by default at least) column -->
		<div class="visualClear"></div>
					<div id="footer" role="contentinfo">
						<div id="f-copyrightico">
									<a href="https://creativecommons.org/licenses/by/3.0/"><img src="https://i.creativecommons.org/l/by/3.0/88x31.png" alt="Attribution 3.0 Unported" width="88" height="31" /></a>
							</div>
					<div id="f-poweredbyico">
									<a href="//www.mediawiki.org/"><img src="/w/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
							</div>
					<ul id="f-list">
									<li id="lastmod"> This page was last modified on 16 October 2008, at 17:12.</li>
									<li id="viewcount">This page has been accessed 10,862 times.</li>
									<li id="copyright">Content is available under <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by/3.0/">Attribution 3.0 Unported</a> unless otherwise noted.</li>
									<li id="privacy"><a href="/wiki/awesome:Privacy_policy" title="awesome:Privacy policy">Privacy policy</a></li>
									<li id="about"><a href="/wiki/awesome:About" title="awesome:About">About awesome</a></li>
									<li id="disclaimer"><a href="/wiki/awesome:General_disclaimer" title="awesome:General disclaimer">Disclaimers</a></li>
							</ul>
		</div>
		</div>
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://awesomewm.org/w/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=monobook\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":81});
}</script></body></html>